\hypertarget{Arduino__Reales_2PBIO__Sprint0_2Publicador_8h_source}{}\doxysection{Publicador.\+h}
\label{Arduino__Reales_2PBIO__Sprint0_2Publicador_8h_source}\index{Arduino\_Reales/PBIO\_Sprint0/Publicador.h@{Arduino\_Reales/PBIO\_Sprint0/Publicador.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// -\/*-\/ mode: c++ -\/*-\/}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{4 \textcolor{comment}{// Jordi Bataller i Mascarell}}
\DoxyCodeLine{5 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#ifndef PUBLICADOR\_H\_INCLUIDO}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#define PUBLICADOR\_H\_INCLUIDO}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{11 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{12 \textcolor{keyword}{class }\mbox{\hyperlink{classPublicador}{Publicador}} \{}
\DoxyCodeLine{13 }
\DoxyCodeLine{14   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{15   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{16 \textcolor{keyword}{private}:}
\DoxyCodeLine{17 }
\DoxyCodeLine{18   \textcolor{comment}{/*uint8\_t beaconUUID[16] = \{ //UUID del Beacon // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ CAMBIAR}}
\DoxyCodeLine{19 \textcolor{comment}{    'E', 'P', 'S', 'G', '-\/', 'G', 'T', 'I', }}
\DoxyCodeLine{20 \textcolor{comment}{    '-\/', 'P', 'R', 'O', 'Y', '-\/', '3', 'A'}}
\DoxyCodeLine{21 \textcolor{comment}{    \};*/}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 uint8\_t beaconUUID[16] = \{ \textcolor{comment}{//UUID del Beacon // -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ CAMBIAR}}
\DoxyCodeLine{24   \textcolor{charliteral}{'E'}, \textcolor{charliteral}{'S'}, \textcolor{charliteral}{'T'}, \textcolor{charliteral}{'O'}, \textcolor{charliteral}{'-\/'}, \textcolor{charliteral}{'E'}, \textcolor{charliteral}{'S'}, \textcolor{charliteral}{'-\/'}, }
\DoxyCodeLine{25   \textcolor{charliteral}{'U'}, \textcolor{charliteral}{'N'}, \textcolor{charliteral}{'-\/'}, \textcolor{charliteral}{'T'}, \textcolor{charliteral}{'E'}, \textcolor{charliteral}{'X'}, \textcolor{charliteral}{'T'}, \textcolor{charliteral}{'O'}}
\DoxyCodeLine{26   \};}
\DoxyCodeLine{27   }
\DoxyCodeLine{28 }
\DoxyCodeLine{29   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{30   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{31 \textcolor{keyword}{public}:}
\DoxyCodeLine{32   \mbox{\hyperlink{classEmisoraBLE}{EmisoraBLE}} laEmisora \{}
\DoxyCodeLine{33     \textcolor{stringliteral}{"{}Manolito"{}}, \textcolor{comment}{//  nombre emisora   //Nombre que aparece como dispositivo en nRFConnect -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ CAMBIAR}}
\DoxyCodeLine{34       0x004c, \textcolor{comment}{// fabricanteID (Apple)}}
\DoxyCodeLine{35       4 \textcolor{comment}{// txPower}}
\DoxyCodeLine{36       \};}
\DoxyCodeLine{37   }
\DoxyCodeLine{38   \textcolor{keyword}{const} \textcolor{keywordtype}{int} RSSI = -\/53;}
\DoxyCodeLine{39 }
\DoxyCodeLine{40   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{41   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{42 \textcolor{keyword}{public}:}
\DoxyCodeLine{43 }
\DoxyCodeLine{44   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{45   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{46   \textcolor{keyword}{enum} MedicionesID  \{  \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ CAMBIAR}}
\DoxyCodeLine{47     CO2 = 11,}
\DoxyCodeLine{48     TEMPERATURA = 12,}
\DoxyCodeLine{49     RUIDO = 13}
\DoxyCodeLine{50   \};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{53   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{54   \mbox{\hyperlink{classPublicador}{Publicador}}( ) \{}
\DoxyCodeLine{55     \textcolor{comment}{// ATENCION: no hacerlo aquí. (*this).laEmisora.encenderEmisora();}}
\DoxyCodeLine{56     \textcolor{comment}{// Pondremos un método para llamarlo desde el setup() más tarde}}
\DoxyCodeLine{57   \} \textcolor{comment}{// ()}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{60   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{61   \textcolor{keywordtype}{void} encenderEmisora() \{}
\DoxyCodeLine{62     (*this).laEmisora.encenderEmisora();}
\DoxyCodeLine{63   \} \textcolor{comment}{// ()}}
\DoxyCodeLine{64 }
\DoxyCodeLine{65   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{66   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{67   \textcolor{keywordtype}{void} publicarCO2( int16\_t valorCO2, uint8\_t contador, \textcolor{keywordtype}{long} tiempoEspera ) \{}
\DoxyCodeLine{68 }
\DoxyCodeLine{69     \textcolor{comment}{//}}
\DoxyCodeLine{70     \textcolor{comment}{// 1. empezamos anuncio}}
\DoxyCodeLine{71     \textcolor{comment}{//}}
\DoxyCodeLine{72     uint16\_t major = (MedicionesID::CO2 << 8) + contador;}
\DoxyCodeLine{73     (*this).laEmisora.emitirAnuncioIBeacon( (*this).beaconUUID, }
\DoxyCodeLine{74                                             major,}
\DoxyCodeLine{75                                             valorCO2, \textcolor{comment}{// minor}}
\DoxyCodeLine{76                                             (*this).RSSI \textcolor{comment}{// rssi}}
\DoxyCodeLine{77                                     );}
\DoxyCodeLine{78 }
\DoxyCodeLine{79     \textcolor{comment}{/*}}
\DoxyCodeLine{80 \textcolor{comment}{    Globales::elPuerto.escribir( "{}   publicarCO2(): valor="{} );}}
\DoxyCodeLine{81 \textcolor{comment}{    Globales::elPuerto.escribir( valorCO2 );}}
\DoxyCodeLine{82 \textcolor{comment}{    Globales::elPuerto.escribir( "{}   contador="{} );}}
\DoxyCodeLine{83 \textcolor{comment}{    Globales::elPuerto.escribir( contador );}}
\DoxyCodeLine{84 \textcolor{comment}{    Globales::elPuerto.escribir( "{}   todo="{}  );}}
\DoxyCodeLine{85 \textcolor{comment}{    Globales::elPuerto.escribir( major );}}
\DoxyCodeLine{86 \textcolor{comment}{    Globales::elPuerto.escribir( "{}\(\backslash\)n"{} );}}
\DoxyCodeLine{87 \textcolor{comment}{    */}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89     \textcolor{comment}{//}}
\DoxyCodeLine{90     \textcolor{comment}{// 2. esperamos el tiempo que nos digan}}
\DoxyCodeLine{91     \textcolor{comment}{//}}
\DoxyCodeLine{92     esperar( tiempoEspera );}
\DoxyCodeLine{93 }
\DoxyCodeLine{94     \textcolor{comment}{//}}
\DoxyCodeLine{95     \textcolor{comment}{// 3. paramos anuncio}}
\DoxyCodeLine{96     \textcolor{comment}{//}}
\DoxyCodeLine{97     (*this).laEmisora.detenerAnuncio();}
\DoxyCodeLine{98   \} \textcolor{comment}{// ()}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{101   \textcolor{comment}{// ............................................................}}
\DoxyCodeLine{102   \textcolor{keywordtype}{void} publicarTemperatura( int16\_t valorTemperatura,}
\DoxyCodeLine{103                             uint8\_t contador, \textcolor{keywordtype}{long} tiempoEspera ) \{}
\DoxyCodeLine{104 }
\DoxyCodeLine{105     uint16\_t major = (MedicionesID::TEMPERATURA << 8) + contador;}
\DoxyCodeLine{106     (*this).laEmisora.emitirAnuncioIBeacon( (*this).beaconUUID, }
\DoxyCodeLine{107                                             major,}
\DoxyCodeLine{108                                             valorTemperatura, \textcolor{comment}{// minor}}
\DoxyCodeLine{109                                             (*this).RSSI \textcolor{comment}{// rssi}}
\DoxyCodeLine{110                                     );}
\DoxyCodeLine{111     esperar( tiempoEspera );}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     (*this).laEmisora.detenerAnuncio();}
\DoxyCodeLine{114   \} \textcolor{comment}{// ()}}
\DoxyCodeLine{115 }
\DoxyCodeLine{116 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{117 \textcolor{comment}{// Función para publicar el valor de concentración de COx y temperatura como un anuncio Beacon.}}
\DoxyCodeLine{118   \textcolor{keywordtype}{void} publicarCoXTemp(int16\_t valorCox, int16\_t valorTemperatura,\textcolor{keywordtype}{long} tiempoEspera)}
\DoxyCodeLine{119   \{}
\DoxyCodeLine{120   (*this).laEmisora.emitirAnuncioIBeacon( (*this).beaconUUID, }
\DoxyCodeLine{121                       valorCox,}
\DoxyCodeLine{122                       valorTemperatura, \textcolor{comment}{// minor}}
\DoxyCodeLine{123                       (*this).RSSI \textcolor{comment}{// rssi}}
\DoxyCodeLine{124                   );}
\DoxyCodeLine{125   esperar( tiempoEspera );}
\DoxyCodeLine{126 }
\DoxyCodeLine{127   (*this).laEmisora.detenerAnuncio();}
\DoxyCodeLine{128   \}}
\DoxyCodeLine{129   }
\DoxyCodeLine{130 \}; \textcolor{comment}{// class}}
\DoxyCodeLine{131 }
\DoxyCodeLine{132 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{133 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{134 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{135 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{136 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
